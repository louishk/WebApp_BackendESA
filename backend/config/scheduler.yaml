# =============================================================================
# ESA Backend - Scheduler Configuration
# =============================================================================
# Non-sensitive settings only.

scheduler:
  enabled: true
  timezone: "Asia/Singapore"
  max_workers: 5
  working_dir: "/var/www/backend/backend/python"

  # Resource limits
  resources:
    db_pool: 10
    soap_api: 5
    http_api: 10
    scheduler_reserved: 2

  # Default retry settings
  retry:
    max_attempts: 3
    delay_seconds: 300
    backoff_multiplier: 2.0
    max_delay_seconds: 3600

  # Batch processing
  batch:
    chunk_size: 500
    compression_threshold: 1024

# Pipeline-specific settings
# Location codes used by: rentroll, discount, mimo, unitsinfo
location_codes: &location_codes
  - "L001"
  - "L002"
  - "L003"
  - "L004"
  - "L005"
  - "L006"
  - "L007"
  - "L008"
  - "L009"
  - "L010"
  - "L011"
  - "L013"
  - "L015"
  - "L017"
  - "L018"
  - "L019"
  - "L020"
  - "L021"
  - "L022"
  - "L023"
  - "L024"
  - "L025"
  - "L026"
  - "L028"
  - "L029"
  - "L030"

pipelines:
  rentroll:
    sql_chunk_size: 300
    location_codes: *location_codes

  discount:
    sql_chunk_size: 500
    location_codes: *location_codes

  mimo:
    sql_chunk_size: 500
    location_codes: *location_codes

  unitsinfo:
    sql_chunk_size: 500
    location_codes: *location_codes

# Alerts
alerts:
  slack:
    enabled: false
    webhook_url_vault: "SLACK_WEBHOOK_URL"  # Reference to vault secret
    channel: "#data-pipeline-alerts"
    notify_on:
      - "failure"
      - "recovery"

  email:
    enabled: false
    smtp_host: "smtp.your-provider.com"
    smtp_port: 587
    smtp_user: "alerts@your-domain.com"
    smtp_password_vault: "SMTP_PASSWORD"  # Reference to vault secret
    from_address: "pbi-scheduler@your-domain.com"
    to_addresses:
      - "data-team@your-domain.com"
