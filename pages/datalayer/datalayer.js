
        
        <script>
(function(){var RS_VERSION="1.2.0",API_TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJmcmVzaCI6ZmFsc2UsImlhdCI6MTc0ODMyOTIzNSwianRpIjoiYmQ3OWMxMTgtOTRkNy00NmM1LWEyYjMtZjEwNmExN2QwYzE2IiwidHlwZSI6ImFjY2VzcyIsInN1YiI6ImRhdGFsYXllciIsIm5iZiI6MTc0ODMyOTIzNSwiY3NyZiI6Ijg4NTIyMTFmLWNkYjEtNGI1Zi1iMWFlLTdkZDRiZjUwZWNkZiIsImV4cCI6MTc3OTg2NTIzNSwicm9sZXMiOlsiZGF0YWxheWVyIiwidXNlciJdfQ.jAA7Xyy9EvlGEQUrs1OluS6iew8fI5ocbgpSr3VwnD0",DEBUG=false,tokenMap={"d800ce8436a7079985319c7ea58d5ec21c85960132d64e16a0af2ff4e74435b01f658f8a01771311eea77f93d2373efe":"L004","5e96f8a7a7c71f44d80f0ed6b7d1ec07f4d13719212890dfa498e16927e7581b47500e080a3944d6346cc3b6c56f534a":"L005","3df1e29fdef2fc4d36f834092775a7424efe16d9f251abc6b2d1a8de5f92cf144e388d615b321d5613f1439480d84dc8":"L006","99a0f2c3e7e876e0c6d7a1b8bba9018932734557c591efb22f7adf688c3cc0cb0b131fe84eea4223cfcf8b9894c58b7a":"L007","e33ec49ffd7a9fc53b62ef5161b311978bac3d44e595f807da51891ca51a860416845885005bc6c661504a2aba558b9c":"L008","94b504386de4ffe852d66f6de876013cfa5016b3df4e4ff20ec8385fe5c279227849c711c801d2b281e2584687727021":"L009","444ca21e232c48d1fbc428e80b6f7c8251b4625963c1c94130af6d11d15a570edb49f04500f9a60ade836c4182c15ea3":"L010"},RETRIES=3,RETRY_DELAY=300,syntheticEvents=["unit-listing-loaded","show-prices"];function detectSiteFromURL(u){try{var t=typeof u==="string"?u:u.url;if(!t.includes("prod.rapidstorapp.com/rapidstor/"))return;var p=t.split("/");if(p.length>=6){var s=p[5],l=tokenMap[s];if(l){window._rsSiteMeta={site_token:s,location_code:l},DEBUG&&console.log("[RS] Site info detected:",window._rsSiteMeta)}}}catch(e){DEBUG&&console.warn("[RS] Site detection failed:",e)}}function getGoogleIdentifiers(){var g=null,c=null;try{var m=window.location.href.match(/[?&]gclid=([^&]*)/);if(m)g=m[1];var a=document.cookie.split("; ").find(function(r){return r.startsWith("_ga=")});if(a){var p=a.split(".");if(p.length===4)c=p[2]+"."+p[3]}}catch(e){DEBUG&&console.warn("[RS] Could not parse GA IDs:",e)}return{gclid:g,google_client_id:c}}var f=window.fetch;window.fetch=function(){detectSiteFromURL(arguments[0]);return f.apply(this,arguments)};var o=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(m,u){detectSiteFromURL(u);return o.apply(this,arguments)};function fallbackToStorage(p){try{var q=JSON.parse(localStorage.getItem("_rs_event_fallback")||"[]");q.push(p);localStorage.setItem("_rs_event_fallback",JSON.stringify(q));DEBUG&&console.warn("[RS] Event saved to fallback queue.")}catch(e){DEBUG&&console.error("[RS] Could not fallback:",e)}}window.rapidstor_api_tracking_listener=function(type,rawContext){DEBUG&&console.log("[RS] Event:",type,rawContext);var context=JSON.parse(JSON.stringify(rawContext||{})),timestamp=new Date().toISOString(),google=getGoogleIdentifiers();context.gclid=google.gclid;context.google_client_id=google.google_client_id;var attempt=0;function send(){attempt++;if(!context.site_info&&window._rsSiteMeta){context.site_info={location_code:window._rsSiteMeta.location_code,site_token:window._rsSiteMeta.site_token};DEBUG&&console.info("[RS] Injected site_info:",context.site_info)}if(!context.site_info&&syntheticEvents.includes(type)&&attempt<=RETRIES){setTimeout(send,RETRY_DELAY);return}window.dataLayer=window.dataLayer||[];window.dataLayer.push({event:type,context:context});var xhr=new XMLHttpRequest();xhr.open("POST","https://api.redboxstorage.hk/datalayer/",true);xhr.setRequestHeader("Content-Type","application/json");xhr.setRequestHeader("Authorization","Bearer "+API_TOKEN);xhr.onreadystatechange=function(){if(xhr.readyState===4){if(xhr.status>=200&&xhr.status<300){DEBUG&&console.info("[RS] Event sent.")}else if(attempt<RETRIES){setTimeout(send,RETRY_DELAY)}else{fallbackToStorage({event_type:type,event_context:context,timestamp:timestamp})}}};xhr.onerror=function(){if(attempt<RETRIES){setTimeout(send,RETRY_DELAY)}else{fallbackToStorage({event_type:type,event_context:context,timestamp:timestamp})}};xhr.send(JSON.stringify({event_type:type,event_context:context,timestamp:timestamp}))}send()};DEBUG&&console.info("[RS] ðŸš€ RapidStor Tracker v"+RS_VERSION+" initialized.")})();
</script>
                          